
  0%|                                                                                                                                                    | 0/1583 [00:00<?, ?it/s]



































































































  6%|████████▌                                                                                                                                | 99/1583 [04:42<1:08:30,  2.77s/it]
  6%|████████▌                                                                                                                               | 100/1583 [04:45<1:08:20,  2.76s/it][INFO|trainer.py:3081] 2023-09-20 10:37:34,211 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 10:37:34,212 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 10:37:34,212 >>   Batch size = 1









 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 121/128 [00:18<00:01,  6.59it/s]





































































































 13%|█████████████████▏                                                                                                                      | 200/1583 [09:59<1:11:04,  3.08s/it]
 13%|█████████████████▏                                                                                                                      | 200/1583 [09:59<1:11:04,  3.08s/it][INFO|trainer.py:3081] 2023-09-20 10:42:49,014 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 10:42:49,015 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 10:42:49,015 >>   Batch size = 1








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 122/128 [00:14<00:00,  8.34it/s]



































































































 19%|█████████████████████████▊                                                                                                              | 300/1583 [15:35<1:10:52,  3.31s/it][INFO|trainer.py:3081] 2023-09-20 10:48:24,549 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 10:48:24,549 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 10:48:24,550 >>   Batch size = 1
  2%|███▎                                                                                                                                         | 3/128 [00:00<00:17,  7.04it/s]










 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 118/128 [00:18<00:01,  6.64it/s]



































































































 25%|██████████████████████████████████▊                                                                                                       | 400/1583 [21:06<59:00,  2.99s/it][INFO|trainer.py:3081] 2023-09-20 10:53:55,570 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 10:53:55,571 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 10:53:55,571 >>   Batch size = 1
  0%|                                                                                                                                                     | 0/128 [00:00<?, ?it/s]








 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 127/128 [00:15<00:00,  8.41it/s]




































































































 32%|███████████████████████████████████████████▌                                                                                              | 499/1583 [26:38<57:30,  3.18s/it]
 32%|███████████████████████████████████████████▌                                                                                              | 500/1583 [26:41<57:20,  3.18s/it][INFO|trainer.py:3081] 2023-09-20 10:59:30,349 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 10:59:30,349 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 10:59:30,349 >>   Batch size = 1







 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 117/128 [00:14<00:01,  8.40it/s]
{'eval_loss': 0.5672129392623901, 'eval_runtime': 16.5255, 'eval_samples_per_second': 30.982, 'eval_steps_per_second': 7.746, 'epoch': 0.32}
09/20/2023 10:59:46 - INFO - utils.trainer - Saving model checkpoint to sft_model_path/checkpoint-500

 32%|███████████████████████████████████████████▌                                                                                              | 500/1583 [26:57<57:20,  3.18s/it][INFO|tokenization_utils_base.py:2210] 2023-09-20 10:59:47,160 >> tokenizer config file saved in sft_model_path/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2217] 2023-09-20 10:59:47,160 >> Special tokens file saved in sft_model_path/checkpoint-500/special_tokens_map.json


































































































 38%|████████████████████████████████████████████████████▏                                                                                     | 599/1583 [32:13<52:08,  3.18s/it]
 38%|████████████████████████████████████████████████████▎                                                                                     | 600/1583 [32:16<51:54,  3.17s/it][INFO|trainer.py:3081] 2023-09-20 11:05:05,270 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:05:05,270 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:05:05,270 >>   Batch size = 1






 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 112/128 [00:13<00:01,  8.48it/s]




































































































 44%|████████████████████████████████████████████████████████████▉                                                                             | 699/1583 [37:48<47:16,  3.21s/it]
 44%|█████████████████████████████████████████████████████████████                                                                             | 700/1583 [37:51<47:13,  3.21s/it][INFO|trainer.py:3081] 2023-09-20 11:10:40,939 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:10:40,939 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:10:40,939 >>   Batch size = 1







 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 123/128 [00:14<00:00,  8.31it/s]




































































































 51%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 800/1583 [43:26<41:40,  3.19s/it][INFO|trainer.py:3081] 2023-09-20 11:16:15,181 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:16:15,181 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:16:15,181 >>   Batch size = 1
{'loss': 0.5624, 'learning_rate': 5.1994944482410145e-05, 'epoch': 0.51}









 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 127/128 [00:19<00:00,  6.62it/s]




































































































 57%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                                        | 900/1583 [48:56<35:00,  3.08s/it][INFO|trainer.py:3081] 2023-09-20 11:21:45,333 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:21:45,333 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:21:45,333 >>   Batch size = 1
  0%|                                                                                                                                                                                  | 0/128 [00:00<?, ?it/s]








 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 114/128 [00:14<00:01,  8.49it/s]



































































































 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                             | 999/1583 [53:45<26:43,  2.75s/it]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                             | 1000/1583 [53:47<26:40,  2.75s/it][INFO|trainer.py:3081] 2023-09-20 11:26:37,062 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:26:37,062 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:26:37,062 >>   Batch size = 1







[INFO|tokenization_utils_base.py:2217] 2023-09-20 11:26:54,405 >> Special tokens file saved in sft_model_path/checkpoint-1000/special_tokens_map.json
[INFO|trainer.py:2894] 2023-09-20 11:26:54,913 >> Deleting older checkpoint [sft_model_path/checkpoint-500] due to args.save_total_limit
{'eval_loss': 0.538382887840271, 'eval_runtime': 17.0701, 'eval_samples_per_second': 29.994, 'eval_steps_per_second': 7.498, 'epoch': 0.63}
09/20/2023 11:26:54 - INFO - utils.trainer - Saving model checkpoint to sft_model_path/checkpoint-1000
09/20/2023 11:26:54 - INFO - utils.trainer - Trainer.model is not a `PreTrainedModel`, only saving its state dict.


































































































 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 1099/1583 [58:59<25:20,  3.14s/it]
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 1100/1583 [59:02<25:17,  3.14s/it][INFO|trainer.py:3081] 2023-09-20 11:31:51,386 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:31:51,386 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:31:51,386 >>   Batch size = 1






 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 112/128 [00:13<00:01,  8.50it/s]




































































































 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                       | 1199/1583 [1:03:56<17:33,  2.74s/it]
 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 1200/1583 [1:03:59<17:31,  2.74s/it][INFO|trainer.py:3081] 2023-09-20 11:36:48,592 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:36:48,593 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:36:48,593 >>   Batch size = 1







 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 127/128 [00:15<00:00,  8.41it/s]




































































































 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 1300/1583 [1:09:15<14:48,  3.14s/it][INFO|trainer.py:3081] 2023-09-20 11:42:04,905 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:42:04,905 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:42:04,906 >>   Batch size = 1
{'loss': 0.517, 'learning_rate': 8.380384134202562e-06, 'epoch': 0.82}







 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 119/128 [00:15<00:01,  8.41it/s]




































































































 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 1400/1583 [1:14:26<08:36,  2.82s/it][INFO|trainer.py:3081] 2023-09-20 11:47:15,107 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:47:15,107 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:47:15,107 >>   Batch size = 1
  0%|                                                                                                                                                                                  | 0/128 [00:00<?, ?it/s]








 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 118/128 [00:14<00:01,  8.42it/s]



































































































 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 1500/1583 [1:19:32<04:22,  3.16s/it][INFO|trainer.py:3081] 2023-09-20 11:52:21,883 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:52:21,884 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:52:21,884 >>   Batch size = 1
  0%|                                                                                                                                                                                  | 0/128 [00:00<?, ?it/s]








[INFO|tokenization_utils_base.py:2217] 2023-09-20 11:52:38,707 >> Special tokens file saved in sft_model_path/checkpoint-1500/special_tokens_map.json
{'eval_loss': 0.5224965214729309, 'eval_runtime': 16.5245, 'eval_samples_per_second': 30.984, 'eval_steps_per_second': 7.746, 'epoch': 0.95}
09/20/2023 11:52:38 - INFO - utils.trainer - Saving model checkpoint to sft_model_path/checkpoint-1500
09/20/2023 11:52:38 - INFO - utils.trainer - Trainer.model is not a `PreTrainedModel`, only saving its state dict.
[INFO|trainer.py:2894] 2023-09-20 11:52:39,221 >> Deleting older checkpoint [sft_model_path/checkpoint-1000] due to args.save_total_limit

















































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1583/1583 [1:23:43<00:00,  2.73s/it][INFO|trainer.py:1934] 2023-09-20 11:56:32,304 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1583/1583 [1:23:43<00:00,  3.17s/it]
[INFO|tokenization_utils_base.py:2210] 2023-09-20 11:56:32,594 >> tokenizer config file saved in sft_model_path/tokenizer_config.json
[INFO|tokenization_utils_base.py:2217] 2023-09-20 11:56:32,594 >> Special tokens file saved in sft_model_path/special_tokens_map.json
[INFO|trainer.py:3081] 2023-09-20 11:56:32,604 >> ***** Running Evaluation *****
[INFO|trainer.py:3083] 2023-09-20 11:56:32,604 >>   Num examples = 512
[INFO|trainer.py:3086] 2023-09-20 11:56:32,604 >>   Batch size = 1
  2%|██▋                                                                                                                                                                       | 2/128 [00:00<00:07, 16.57it/s]
{'train_runtime': 5035.0082, 'train_samples_per_second': 10.063, 'train_steps_per_second': 0.314, 'train_loss': 0.8292850728134377, 'epoch': 1.0}
09/20/2023 11:56:32 - INFO - utils.trainer - Saving model checkpoint to sft_model_path
09/20/2023 11:56:32 - INFO - utils.trainer - Trainer.model is not a `PreTrainedModel`, only saving its state dict.
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     0.8293
  train_runtime            = 1:23:55.00
  train_samples_per_second =     10.063








100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:15<00:00,  8.26it/s]
***** eval metrics *****
  epoch                   =        1.0
  eval_loss               =     0.5223
  eval_runtime            = 0:00:16.18
  eval_samples_per_second =      31.64
  eval_steps_per_second   =       7.91
  perplexity              =     1.6858